#!/usr/bin/env python3

#Coded by S4RR4
#Contributed by გიო რგი

import os
os.system('clear')

import signal

def keyboardInterruptHandler(signal, frame):
    print("\nპროგრამა გაითიშა.".format(signal))
    exit(0)

signal.signal(signal.SIGINT, keyboardInterruptHandler)

import subprocess

print("   ___           _            _          __            _      ")    
print("  / _ \___ _ __ | |_ ___  ___| |_       / /  ___  _ __(_)___  ") 
print(" / /_)/ _ \ '_ \| __/ _ \/ __| __|____ / /  / _ \| '__| / __| ")
print("/ ___/  __/ | | | ||  __/\__ \ ||_____/ /__| (_) | |  | \__ \ ")
print("\/    \___|_| |_|\__\___||___/\__|    \____/\___/|_|  |_|___/ ")
print("\n                   ▶ Coded by S4RR4 ◀\n                     ")
print("               ▶ Contributed by გიო რგი ◀\n                   ")
print("https://github.com/AnonymousFromGeorgia/Pentest-Loris         ")
print("\nℹ️Pentest-Loris ეს არის უფასო Python3 სკრიპტი, რომლის დახმარებით")
print("შეგიძლიათ გაიმარტივოთ პენტესტინგის პროცესი და გახადოთ ავტომატური.\n")
print("ℹ️სკრიპტი გამართულად მუშაობს Parrot Security OS და Kali Linux-ზე.\n")                                                             

print("[1] Webapp (ვებაპლიკაცია, ვებსაიტი)")
print("[2] PC/Laptop (პერსონალური კომპიუტერი, ლეპტოპი)\n")
which = input("აირჩიეთ სასურველი სამიზნის ტიპი: ")

if which == '1':
	url = input("შეიყვანეთ საიტის URL (მაგალითად: http://nimushi.ge): ")
	subprocess.call(["figlet", "Whatweb"])
	subprocess.call(["whatweb", url])
                                               
	iswp = input("\nსაიტი Wordpress-ის ძრავზეა? (კი/არა): ")
	ip = input("მიუთითეთ IP რომელიც Whatweb-მა დაადგინა: ")
	if iswp == 'კი':
		
		
		subprocess.call(["figlet", "Vulnerable", "themes"])	
		ask1 = input("გსურთ რომ შეინახოთ სკანირების შედეგის ლოგი? (კი/არა): ")
		if ask1 == 'კი':
			resultname1 = input("მიუთითეთ შენახული ლოგის სახელი (მაგ. themes-log): ")
			subprocess.call(["wpscan", "--url", url, "--enumerate", "vt", "-o", resultname1])
		else:
			subprocess.call(["wpscan", "--url", url, "--enumerate", "vt"])
		
		subprocess.call(["figlet", "Vulnerable", "plugins"])
		ask2 = input("\nგსურთ რომ შეინახოთ სკანირების შედეგის ლოგი? (კი/არა): ")
	
		if ask2 == 'კი':
			resultname2 = input("მიუთითეთ შენახული ლოგის სახელი (მაგ. plugins-log): ")
			subprocess.call(["wpscan", "--url", url, "--enumerate", "vp", "-o", resultname2])
		else:
			subprocess.call(["wpscan", "--url", url, "--enumerate", "vp"])
		
		subprocess.call(["figlet","Enumerating", "usernames"])
		ask3 = input("\nგსურთ რომ შეინახოთ სკანირების შედეგის ლოგი? (კი/არა): ")
		if ask3 == 'კი':
			resultname3 = input("მიუთითეთ შენახული ლოგის სახელი (მაგ. usernames-log): ")
			subprocess.call(["wpscan", "--url", url, "--enumerate", "u", "-o", resultname3])
		else:
			subprocess.call(["wpscan", "--url", url, "--enumerate", "u"])

		bf = input("\nგნებავთ განახორციელოთ Bruteforce შეტევა? (კი/არა): ")
		
		
		if bf == "კი":
			Wlist = input("შეიყვანე Wordlist-ის მისამართი (მაგ: /root/wordlist.txt): ")
			uname = input("შეიყვანე მსხვერპლის ლოგინი (Username): ")
			ask4 = input("გსურთ რომ შეინახოთ სკანირების შედეგის ლოგი? (კი/არა): ")
			if ask4 == 'კი':
				resultname4 = input("მიუთითეთ შენახული ლოგის სახელი (მაგ. bruteforce-log): ")
				subprocess.call(["wpscan" ,"--url", url, "--passwords", Wlist, "--usernames", uname, "-o", resultname4])
			else:
				subprocess.call(["wpscan" ,"--url", url, "--passwords", Wlist, "--usernames", uname])
			
					
		else:
			
			print("პროგრამა გადავიდა შემდეგ ხელსაწყოზე ან მიმდინარე ხელსაწყოს სხვა ფუნქციაზე!\n")
	
	
	
	else:
		pass	
		
	
	if iswp != 'wp':
		nikto = input("\nდაიწყოს nikto-მ სკანირება? (კი/არა): ")
		
		if nikto == 'კი':
			subprocess.call(["figlet", "Nikto", "scan"])
			ask5 = input("\nგსურთ რომ შეინახოთ სკანირების შედეგის ლოგი? (კი/არა): ")
			if ask5 == 'კი': 
				subprocess.call(["nikto", "-h", url, "-C", "all", "-o", "nikto-log.txt"])
			else:
				subprocess.call(["nikto", "-h", url, "-C", "all"])
		
		
		
		else:
			pass
	
	else:
		pass
			
	
	nmap = input("დაასკანიროს nmap-მა სერვერი უფრო დეტალურად? (კი/არა): ")
	if nmap == 'კი':
	
		subprocess.call(["figlet", "Nmap", "scan"])
		print('\n')
		print("nmap-ით სკანირებას დაჭირდება დაახლოებით 10წთ.\n შედეგად უნდა მივიღოთ დეტალური ინფორმაცია სერვერზე\n სისუსტეები და ყველა ღია პორტი!")
		print('\n')
		ask6 = input("გსურთ რომ შეინახოთ სკანირების შედეგის ლოგი? (კი/არა): ")
		if ask6 == 'კი':
		
			print("\n")
			resultname6 = input("მიუთითეთ შენახული ლოგის სახელი (მაგ. nmap-log): ")
			subprocess.call(["nmap", "-A", "-T4", "-p-", "-sC", "--script", "vuln", ip, "-oN", resultname6])	
		else:
			subprocess.call(["nmap", "-A", "-T4", "-p-", "-sC", "--script", "vuln", ip])

	else:
		print("პროგრამა გადავიდა შემდეგ ხელსაწყოზე ან მიმდინარე ხელსაწყოს სხვა ფუნქციაზე!\n")
	
	
	
	cewl = input("გსურთ შექმნათ კონკრეტული საიტისთვის მორგებული Wordlist? (კი/არა): ")
	if cewl == 'კი':
		subprocess.call(["figlet", "Cewl"])
		cewlwordlist = input("მიუთითეთ Wordlist-ის სახელი (მაგ. wordlist): ")
		subprocess.call(["cewl", url, "-w" ,cewlwordlist])

		print(celwordlist + " შექმნილია, მოძებნეთ ის ამავე ფოლდერში.")
		
	else:
		print("პროგრამა გადავიდა შემდეგ ხელსაწყოზე!")
	
	
	
	gobuster = input("დაიწყოს Gobuster-მა დირექტორიების ძებნა? (კი/არა): ")
	print('\n')
	if gobuster == 'კი':
		subprocess.call(["figlet", "Gobuster"])
		dirlist = input("შეიყვანე Wordlist-ის მისამართი (მაგ: /root/wordlist.txt): ")
		ask7 = input("გსურთ რომ შეინახოთ სკანირების შედეგის ლოგი? (კი/არა): ")
		if ask7 == 'კი':
			resultname7 = input("მიუთითეთ შენახული ლოგის სახელი (მაგ. gobuster-log): ")
			subprocess.call(["gobuster", "dir", "-u" , url, "-w", dirlist, "-o", resultname7])
		else:
			subprocess.call(["gobuster", "dir", "-u" , url, "-w", dirlist])
	
					
else:
	pass	
	

print('\n')

if which == '2':
	
	nmap = input("დაასკანიროს nmap-მა სერვერი უფრო დეტალურად? (კი/არა): ")
	if nmap == 'კი':
	
		subprocess.call(["figlet", "Nmap", "scan"])
		print('\n')
		print("nmap-ით სკანირებას დაჭირდება დაახლოებით 10წთ.\n შედეგად უნდა მივიღოთ დეტალური ინფორმაცია სერვერზე\n სისუსტეები და ყველა ღია პორტი!")
		print('\n')
		ask6 = input("გსურთ რომ შეინახოთ სკანირების შედეგის ლოგი? (კი/არა): ")
		if ask6 == 'კი':
		
			print("\n")
			resultname6 = input("მიუთითეთ შენახული ლოგის სახელი (მაგ. nmap-log): ")
			subprocess.call(["nmap", "-A", "-T4", "-p-", "-sC", "--script", "vuln", ip, "-oN", resultname6])	
		else:
			subprocess.call(["nmap", "-A", "-T4", "-p-", "-sC", "--script", "vuln", ip])

	else:
		pass

	

	if nmap or ask == 'კი':
	
		print("პროგრამა გადავიდა შემდეგ ხელსაწყოზე ან მიმდინარე ხელსაწყოს სხვა ფუნქციაზე!")
		print('\n')
		print("თუ nmap-მა სისუსტე აღმოაჩინა \n მოძებნეთ მისი ექსპლოიტი სახელის მითითებით")
		expl = input("სისუსტე: ")
		subprocess.call(["searchsploit", expl])

else:
	pass


print("სკრიპტმა დაასრულა მუშაობა.")
print("https://youtube.com/AnonymousFromGeorgia")
print("Pentest-Loris Coded by S4RR4")
print("Contributed by გიო რგი")

